<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Details · ReplicateBE</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ReplicateBE</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../syntax/">Syntax</a></li><li class="is-active"><a class="tocitem" href>Details</a><ul class="internal"><li><a class="tocitem" href="#Introduction-1"><span>Introduction</span></a></li><li><a class="tocitem" href="#Materials-and-Methods-1"><span>Materials and Methods</span></a></li><li><a class="tocitem" href="#Validation-1"><span>Validation</span></a></li><li><a class="tocitem" href="#Installation-and-using-1"><span>Installation and using</span></a></li><li><a class="tocitem" href="#Results-1"><span>Results</span></a></li><li><a class="tocitem" href="#Discussion-1"><span>Discussion</span></a></li><li><a class="tocitem" href="#Development-and-version-description-1"><span>Development and version description</span></a></li><li><a class="tocitem" href="#Acknowledgments-1"><span>Acknowledgments</span></a></li><li><a class="tocitem" href="#Literature-Cited-1"><span>Literature Cited</span></a></li></ul></li><li><a class="tocitem" href="../testval/">Validation</a></li><li><a class="tocitem" href="../struct/">Structures</a></li><li><a class="tocitem" href="../api/">Api</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Details</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Details</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PharmCat/ReplicateBE.jl/blob/master/docs/src/details.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Introduction-1"><a class="docs-heading-anchor" href="#Introduction-1">Introduction</a><a class="docs-heading-anchor-permalink" href="#Introduction-1" title="Permalink"></a></h2><p><a href="https://doi.org/10.13140/RG.2.2.27418.39363"><img src="https://img.shields.io/badge/doi-10.13140%2FRG.2.2.27418.39363-blue" alt="doi"/></a></p><p>The replicate designed bioequivalence is a powerful approach to get more information about variation. In some cases the number of subjects required to demonstrate bioequivalence can be reduced by up to about 50% (Van Peer, A., 2010). For a high variability product, replication can really improve the precision and provide more complete intra-individual variation estimate. Also replicate design could be used for reference-scaled average bioequivalence (RSABE) to demonstrate bioequivalence for highly variable drugs (HVDs). With accordance to US FDA guideline linear mixed-effects model procedures, available in PROC MIXED in SAS or equivalent software, should be used for the analysis of replicated crossover studies for average BE (US FDA). At this moment linear mixed model effect analysis can be done with proprietary (SPSS, SAS, Stata) and open source (R:nlme, R:lme4, Julia:MixedModels) software. But not all statistical mixed models packages support flexible covariance structure fitting with structures like “heterogeneous compound symmetry” (CSH), FA0(2). This doesn’t means that lme4 or MixedModels can’t be used for bioequivalence estimation,  but CSH structure not available in this packages and comparison of results performed in SAS/SPSS with lme4 can be problematically. Objective of this work is: to provide instrument to make bioequivalence analysis with type C model and a development of a demonstrative code for step-by-step clarification of mixed model computation procedure for any interested developers.</p><h2 id="Materials-and-Methods-1"><a class="docs-heading-anchor" href="#Materials-and-Methods-1">Materials and Methods</a><a class="docs-heading-anchor-permalink" href="#Materials-and-Methods-1" title="Permalink"></a></h2><p>FDA recommended model can be described with following equation (Patterson, 2002; US FDA):</p><div>\[ Y_{ijkl} = \mu_k + \gamma_{ikl} + \delta_{ijk} + \varepsilon_{ijkl}\]</div><p>Where  <span>$i=1,…s$</span> indicates sequence, <span>$j=1,…n_i$</span> - subjects,  <span>$k=R,T$</span> – treatment, <span>$l=1,2$</span> indicates replicate on treatment <span>$k$</span> for subjects within sequence <span>$i$</span>. <span>$Y_ijkl$</span> is the response of replicate <span>$l$</span> on treatment <span>$k$</span> for subject <span>$j$</span> in sequence <span>$i$</span>, <span>$γ_ikl$</span> represents the fixed effect of replicate <span>$l$</span> on treatment <span>$k$</span> in sequence <span>$i$</span>, <span>$δ_ijk$</span> is the random subject effect for subject <span>$j$</span>  in sequence <span>$i$</span> on treatment <span>$k$</span>, and <span>$ε_{ijkl}$</span> is the random error for subject <span>$j$</span> within sequence <span>$i$</span> on replicate <span>$l$</span> of treatment <span>$k$</span>.  The <span>$ε_{ijkl}$</span> are assumed to be mutually independent and identically distributed as</p><div>\[\varepsilon_{ijkl} \sim N(0, \sigma_{Wk}^2)\]</div><p>And the random subject effects are assumed to be mutually independent and distributed as</p><div>\[\delta_{ij} \sim N_2
\begin{bmatrix}
    \begin{pmatrix}  \mu_R  \\ \mu_T \end
    {pmatrix}\begin{pmatrix}\sigma_{BR}^{2} &amp;  \rho\sigma_{BT}\sigma_{BR} \\
    \rho\sigma_{BT}\sigma_{BR} &amp; \sigma_{BR}^{2}
    \end{pmatrix}
\end{bmatrix}\]</div><p>Following code illustrates an example of program statements to run the average bioequivalence analysis using PROC MIXED in SAS:</p><pre><code class="language-sas">PROC MIXED;
CLASSES SEQ SUBJ PER TRT;
MODEL  Y = SEQ PER TRT/ DDFM=SATTERTH;
RANDOM  TRT/TYPE=FA0(2) SUB=SUBJ G;
REPEATED/GRP=TRT SUB=SUBJ;
ESTIMATE &#39;T vs. R&#39; TRT 1 -1/CL ALPHA=0.1;</code></pre><p>Statement TYPE=CSH also can be used to match the model described above.</p><p>In matrix notation a mixed effect model can be represented as:</p><div>\[y = X\beta + Zu + \epsilon\]</div><p>And gives Henderson&#39;s «mixed model equations»:</p><div>\[\begin{pmatrix}X&#39;R^{-1}X&amp;X&#39;R^{-1}Z\\Z&#39;R^{-1}X&amp;Z&#39;R^{-1}Z+G_{-1}\end{pmatrix}  \begin{pmatrix}\widehat{\beta} \\ \widehat{u} \end{pmatrix}= \begin{pmatrix}X&#39;R^{-1}y\\Z&#39;R^{-1}y\end{pmatrix}\]</div><p>The solution to the mixed model equations is a maximum likelihood estimate when the distribution of the errors is normal. PROC MIXED in SAS used restricted maximum likelihood (REML) approach by default. REML equation can be described with following (Henderson,  1959;Laird et.al. 1982; Jennrich 1986; Lindstrom &amp; Bates, 1988; Gurka et.al 2006):</p><div>\[logREML(\theta,\beta) = -\frac{N-p}{2} - \frac{1}{2}\sum_{i=1}^nlog|V_{i}|-

-\frac{1}{2}log|\sum_{i=1}^nX_i&#39;V_i^{-1}X_i|-\frac{1}{2}\sum_{i=1}^n(y_i - X_{i}\beta)&#39;V_i^{-1}(y_i - X_{i}\beta)\]</div><p>Where</p><div>\[\beta = {(\sum_{i=1}^n X_{i}&#39;V_i^{-1}X_{i})}^{-1}(\sum_{i=1}^n X_{i}&#39;V_i^{-1}y_{i})\]</div><p>Where</p><div>\[V_{i} = Z_{i}GZ_i&#39;+R_{i}\]</div><p>Where <span>$N$</span> – total number of observations, <span>$n$</span> – number of independent sampling units (subjects), <span>$y_i$</span> individual response vector,  <span>$X_i$</span> individual design matrix of fixed effects, <span>$β$</span> vector of fixed effects parameters, <span>$V_i$</span> individual covariance matrix for the response vector, <span>$Z_i$</span> individual design matrix of random effects,  <span>$G$</span> covariance matrix of <span>$u$</span> (random effect), <span>$R_i$</span> individual covariance matrix  of  <span>$ϵ$</span> (residual error). Finding solution for minimization  -2logL(θ) respectively to θ can be done with Newton’s family methods. In ReplicateBE used optimization with Optim.jl package (Newton&#39;s Method). In some cases post-optimization step can be performed with  Broyden–Fletcher–Goldfarb–Shanno  method ((L)-BFGS)(Fletcher &amp; Roger, 1987; Wright, 2006). Because variance have only positive values and ρ is limited as -1 ≤ ρ ≤1 in CSH (SAS implementation) and 0 ≤ ρ ≤1 in ReplicateBE &quot;link&quot; function is used. Exponential values is optimizing in variance part and ρ is linked with sigmoid function. All steps perform with differentiable functions with forward automatic differentiation using ForwardDiff package. ForwardDiff is a Julia package for forward-mode automatic differentiation (AD) featuring performance competitive with low-level languages like C++. Unlike recently developed AD tools in other popular high-level languages such as Python and MATLAB, ForwardDiff takes advantage of just-in-time (JIT) compilation to transparently recompile AD-unaware user code, enabling efficient support for higher-order differentiation and differentiation using custom number types (including complex numbers). The field of automatic differentiation provides methods for automatically computing exact derivatives (up to floating-point error) given only the function itself (Revels et al., 2016; Mogensen et al., 2018).</p><p>After solving optimization problem other statistical parameters can be found (Giesbrecht &amp; Burns, 1985; Hrong-Tai Fai &amp; Corneliu 1996; Schaalje et al 2002):</p><div>\[F = \frac{\beta&#39;L&#39;(LCL&#39;)^{-1}L\beta}{rank(LCL&#39;)}\]</div><p>Where</p><div>\[C = \sum_{i=1}^{n} X_i&#39;V_i^{-1}X_i\]</div><p>And</p><div>\[se = \sqrt{LCL&#39;}\]</div><p>Degree of freedom (DF) computed with Satterthwaite approximation or with “contain” method (N – rank(XZ)).</p><div>\[df = \frac{2(LCL&#39;)^{2}}{g&#39;Ag}\]</div><p>Where  <span>$A = 2H^{-1}$</span>; <span>$g = \triangledown_{\theta}(LC^{-1}_{\theta}L&#39;)$</span></p><p>Where L is a vector of known constant, C – variance-covariance matrix of fixed effects (var(β)), H – hessian matrix of REML function, N – total number of observations.</p><h2 id="Validation-1"><a class="docs-heading-anchor" href="#Validation-1">Validation</a><a class="docs-heading-anchor-permalink" href="#Validation-1" title="Permalink"></a></h2><p>ReplicateBE was validated with 6 reference public datasets, 29 generated datasets and simulation study. ReplicateBE is compliant to SAS/SPSS when comparing the following parameters: REML estimate, variance components estimate, fixed effect estimate, standard error of fixed effect estimate. Validation procedures included in package test procedure and perform each time when new version released or can be done at any time on user machine. Validation results (REML &amp; 90% CI) table can be found <a href="https://github.com/PharmCat/ReplicateBE.jl/tree/master/validation">here</a>.</p><p>ReplicateBE include simulation utility, that based on generation multivariate distributed datasets. This can be used not only in purpose of the package diagnostics, but also in purpose of sample size estimation ets. Simulation using version 0.1.4 was performed with 100000 iterations. Confidence interval (95%) for type I error (alpha) is 0.048047 - 0.050733. No statistically significant difference found with acceptable rate (0.05) found. Other simulation results can be found <a href="https://pharmcat.github.io/ReplicateBE.jl/latest/testval/#Simulation-study-1">here</a>.</p><p>Testing procedures cover approximately <a href="https://codecov.io/gh/PharmCat/ReplicateBE.jl"><img src="https://codecov.io/gh/PharmCat/ReplicateBE.jl/branch/master/graph/badge.svg" alt="codecov"/></a> of code, and perform for each release on Travis CI platform: <a href="https://travis-ci.com/PharmCat/ReplicateBE.jl"><img src="https://api.travis-ci.com/PharmCat/ReplicateBE.jl.svg?branch=master" alt="Build Status"/></a>.</p><h2 id="Installation-and-using-1"><a class="docs-heading-anchor" href="#Installation-and-using-1">Installation and using</a><a class="docs-heading-anchor-permalink" href="#Installation-and-using-1" title="Permalink"></a></h2><p>Installation:</p><pre><code class="language-julia">using Pkg; Pkg.add(&quot;ReplicateBE&quot;)</code></pre><p>Basic using:</p><pre><code class="language-julia">using ReplicateBE, StatsBase
be = ReplicateBE.rbe!(df, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence);
ci = confint(be, 0.1)</code></pre><p>Standard output:</p><pre><code class="language-none">Bioequivalence Linear Mixed Effect Model (status: converged)

-2REML: 329.257    REML: -164.629

Fixed effect:
──────────────────────────────────────────────────────────────────────────────────────────────────────
Effect           Value         SE          F          DF        t           P|t|
──────────────────────────────────────────────────────────────────────────────────────────────────────
(Intercept)      4.42158       0.119232    1375.21    68.6064   37.0838     4.0203900000000003e-47*
sequence: 2      0.360591      0.161776    4.96821    62.0      2.22895     0.0294511*
period: 2        0.027051      0.0533388   0.257206   122.73    0.507155    0.612956
period: 3        -0.00625777   0.0561037   0.012441   153.634   -0.111539   0.911334
period: 4        0.036742      0.0561037   0.428886   153.634   0.654894    0.513515
formulation: 2   0.0643404     0.0415345   2.39966    62.0      1.54908     0.126451
──────────────────────────────────────────────────────────────────────────────────────────────────────
Intra-individual variance:
formulation: 1   0.108629   CVᵂ:   33.87   %
formulation: 2   0.0783544   CVᵂ:   28.55   %

Inter-individual variance:
formulation: 1   0.377846
formulation: 2   0.421356
ρ:               0.980288   Cov: 0.391143

Confidence intervals(90%):
formulation: 1 / formulation: 2
Ratio: 93.77, CI: 87.49 - 100.5 (%)
formulation: 2 / formulation: 1
Ratio: 106.65, CI: 99.5 - 114.3 (%)</code></pre><h2 id="Results-1"><a class="docs-heading-anchor" href="#Results-1">Results</a><a class="docs-heading-anchor-permalink" href="#Results-1" title="Permalink"></a></h2><p>ReplicateBE was developed to get mixed model solution to bioequivalence clinical trial. Package repository: <a href="https://badge.fury.io/gh/PharmCat%2FReplicateBE.jl"><img src="https://badge.fury.io/gh/PharmCat%2FReplicateBE.jl.svg" alt="GitHub version"/></a>, Julia 1.0.5 or latest should be installed.</p><h2 id="Discussion-1"><a class="docs-heading-anchor" href="#Discussion-1">Discussion</a><a class="docs-heading-anchor-permalink" href="#Discussion-1" title="Permalink"></a></h2><p>ReplicateBE not designed for modeling in a general purpose, but can be used in situation with similar structure. In part of datasets ReplicateBE showed better optimization result as SPSS. Also ReplicateBE based on direct inversing of variance-covarance matrix V, so computation of <span>$V^{-1}$</span> may be time expensive if size of matrix is big. This does not happen in bioequivalence study where size of <span>$V$</span> is no more 4 (4 periods). But in general this can be serious performance disadvantage. This situation can be avoided using sweep based transformations (Wolfinger et al., 1994). In ReplicateBE variance structure strictly denoted and can’t be changed, but it can be a target in package developing path. In ReplicateBE Satterthwaite degree of freedom (DF) estimate is equal with SAS/SPSS DF estimate for full-replicated basic bioequivalence balanced and unbalanced datasets (2x2x4, 2x2x3), and can be unequal in datasets with dropouts. Validation results for half-replicated designs (2x3x3) or 2x4x4 designs can be found in validation results table.  </p><h2 id="Development-and-version-description-1"><a class="docs-heading-anchor" href="#Development-and-version-description-1">Development and version description</a><a class="docs-heading-anchor-permalink" href="#Development-and-version-description-1" title="Permalink"></a></h2><p>Version format: <span>$X.Y.Z$</span></p><ul><li><span>$0.0.Z$</span> - alpha release, not ready for publics deploy;</li><li><span>$0.Y.Z$</span> - beta release, ready for publics deploy and testing;</li><li><span>$1.0.Z$</span> - publics release with stable API and description of validation procedures, can be unstable or validation program can cover not all package functionality;</li><li><span>$1.1.0$</span> - stable public release;</li></ul><p>When <span>$Z$</span> changed - bugfix or minor changes, not affect on API.</p><p>When <span>$Y$</span> changed - minor patch, may include changes in functionality, but not include breaking changes.</p><p>When <span>$X$</span> changed - major release, may include breaking changes.</p><h2 id="Acknowledgments-1"><a class="docs-heading-anchor" href="#Acknowledgments-1">Acknowledgments</a><a class="docs-heading-anchor-permalink" href="#Acknowledgments-1" title="Permalink"></a></h2><p>D.Sc. in Physical and Mathematical Sciences Anastasia Shitova a.shitova@qayar.ru</p><h2 id="Literature-Cited-1"><a class="docs-heading-anchor" href="#Literature-Cited-1">Literature Cited</a><a class="docs-heading-anchor-permalink" href="#Literature-Cited-1" title="Permalink"></a></h2><ul><li>FDA Guidance for Industry: Statistical Approaches to Establishing Bioequivalence, 2001</li><li>Fletcher, Roger (1987), Practical methods of optimization (2nd ed.), New York: John Wiley &amp; Sons, ISBN 978-0-471-91547-8</li><li>Giesbrecht, F. G., and Burns, J. C. (1985), &quot;Two-Stage Analysis Based on a Mixed Model: Large-sample Asymptotic Theory and Small-Sample Simulation Results,&quot; Biometrics, 41, 853-862.</li><li>Gurka, Matthew. (2006). Selecting the Best Linear Mixed Model under REML. The American Statistician. 60. 19-26. 10.1198/000313006X90396.</li><li>Henderson, C. R., et al. “The Estimation of Environmental and Genetic Trends from Records Subject to Culling.” Biometrics, vol. 15, no. 2, 1959, pp. 192–218. JSTOR, www.jstor.org/stable/2527669.</li><li>Hrong-Tai Fai &amp; Cornelius (1996) Approximate F-tests of multiple degree of freedom hypotheses in generalized least squares analyses of unbalanced split-plot experiments, Journal of Statistical Computation and Simulation, 54:4, 363-378, DOI: 10.1080/00949659608811740</li><li>Jennrich, R., &amp; Schluchter, M. (1986). Unbalanced Repeated-Measures Models with Structured Covariance Matrices. Biometrics, 42(4), 805-820. doi:10.2307/2530695</li><li>Laird, Nan M., and James H. Ware. “Random-Effects Models for Longitudinal Data.” Biometrics, vol. 38, no. 4, 1982, pp. 963–974. JSTOR, www.jstor.org/stable/2529876.</li><li>Lindstrom &amp; J.; Bates, M. (1988). Newton—Raphson and EM Algorithms for Linear Mixed-Effects Models for Repeated-Measures Data. Journal of the American Statistical Association. 83. 1014. 10.1080/01621459.1988.10478693.</li><li>Mogensen et al., (2018). Optim: A mathematical optimization package for Julia. Journal of Open Source Software, 3(24), 615,doi: 10.21105/joss.00615</li><li>Patterson, S. D. and Jones, B. (2002), Bioequivalence and the pharmaceutical industry. Pharmaceut. Statist., 1: 83-95. doi:10.1002/pst.15</li><li>Revels, Jarrett &amp; Lubin, Miles &amp; Papamarkou, Theodore. (2016). Forward-Mode Automatic Differentiation in Julia.</li><li>Schaalje GB, McBride JB, Fellingham GW. Adequacy of approximations to distributions of test statistics in complex mixed linear models. J Agric Biol Environ Stat. 2002;7:512–24.</li><li>Van Peer, A. (2010), Variability and Impact on Design of Bioequivalence Studies. Basic &amp; Clinical Pharmacology &amp; Toxicology, 106: 146-153. doi:10.1111/j.1742-7843.2009.00485.x</li><li>Wolfinger et al., (1994) Computing gaussian likelihoods and their derivatives for general linear mixed models doi: 10.1137/0915079</li><li>Wright, Stephen, and Jorge Nocedal (2006) &quot;Numerical optimization.&quot; Springer</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../syntax/">« Syntax</a><a class="docs-footer-nextpage" href="../testval/">Validation »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 30 November 2019 20:40">Saturday 30 November 2019</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
