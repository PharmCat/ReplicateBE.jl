var documenterSearchIndex = {"docs":
[{"location":"struct/#Structures","page":"-","title":"Structures","text":"","category":"section"},{"location":"struct/#ReplicateBE.ContrastTable","page":"-","title":"ReplicateBE.ContrastTable","text":"","category":"section"},{"location":"struct/","page":"-","title":"-","text":"ReplicateBE.ContrastTable","category":"page"},{"location":"struct/#ReplicateBE.ContrastTable","page":"-","title":"ReplicateBE.ContrastTable","text":"struct ContrastTable <: RBETable\n    name::Vector   # Name\n    f::Vector      # F value\n    ndf::Vector    # Denom degree of freedom\n    df::Vector     # Degree of freedom\n    p::Vector      # p value\nend\n\n\n\n\n\n","category":"type"},{"location":"struct/#ReplicateBE.Design","page":"-","title":"ReplicateBE.Design","text":"","category":"section"},{"location":"struct/","page":"-","title":"-","text":"ReplicateBE.Design","category":"page"},{"location":"struct/#ReplicateBE.Design","page":"-","title":"ReplicateBE.Design","text":"struct Design\n    obs::Int              # Total observation\n    subj::Int             # Subjects\n    sqn::Int              # Sequences\n    pn::Int               # Periods\n    fn::Int               # Formulations\n    sbf::Vector{Int}      # Subject by formulation\n    rankx::Int            # Rank X\n    rankxz::Int           # Rank XZ\n    df2::Int              # DF (robust): Subjects - Sequence\n    df3::Int              # DF (contain): Observations - Rank(XZ)\n    df4::Int              # DF (Subj(Form)): sum(sbf) - sqn - 1                 # Experimental\nend\n\nTrial design description.\n\n\n\n\n\n","category":"type"},{"location":"struct/#ReplicateBE.EffectTable","page":"-","title":"ReplicateBE.EffectTable","text":"","category":"section"},{"location":"struct/","page":"-","title":"-","text":"ReplicateBE.EffectTable","category":"page"},{"location":"struct/#ReplicateBE.EffectTable","page":"-","title":"ReplicateBE.EffectTable","text":"struct EffectTable <: RBETable\n    name::Tuple{Vararg}   # Name\n    est::Tuple{Vararg}    # Estimate\n    se::Tuple{Vararg}     # Etandard error\n    f::Tuple{Vararg}      # F value\n    df::Tuple{Vararg}     # Degree of freedom\n    t::Tuple{Vararg}      # t value\n    p::Tuple{Vararg}      # p value\nend\n\n\n\n\n\n","category":"type"},{"location":"struct/#ReplicateBE.EstimateTable","page":"-","title":"ReplicateBE.EstimateTable","text":"","category":"section"},{"location":"struct/","page":"-","title":"-","text":"ReplicateBE.EstimateTable","category":"page"},{"location":"struct/#ReplicateBE.EstimateTable","page":"-","title":"ReplicateBE.EstimateTable","text":"struct EstimateTable <: RBETable\n    name::Vector   # Name\n    est::Vector    # Estimate\n    se::Vector     # Etandard error\n    df::Vector     # Degree of freedom\n    t::Vector      # t value\n    p::Vector      # p value\n    ll::Vector     # Confidece interval lower bound\n    ul::Vector     # Confidece interval upper bound\n    alpha::Real    # Confidece interval alpha level\nend\n\n\n\n\n\n","category":"type"},{"location":"struct/#ReplicateBE.RandRBEDS","page":"-","title":"ReplicateBE.RandRBEDS","text":"","category":"section"},{"location":"struct/","page":"-","title":"-","text":"ReplicateBE.RandRBEDS","category":"page"},{"location":"struct/#ReplicateBE.RandRBEDS","page":"-","title":"ReplicateBE.RandRBEDS","text":"Random dataset task.\n\nmutable struct RandRBEDS\n    n::Int                       # Subjects number\n    sequence::Vector             # Sequence distribution vector\n    design::Matrix               # Design matrix\n    inter::Vector                # Intersubject variance part\n    intra::Vector                # Intrasubject variance part\n                                 # Fixed effect:\n    intercept::Real              # Intercept\n    seqcoef::Vector              # Sequence\n    periodcoef::Vector           # Period\n    formcoef::Vector             # Formulation\n    dropobs::Int                 # Drop observations\n    seed                         # Seed\nend\n\n\n\n\n\n","category":"type"},{"location":"api/#API","page":"Api","title":"API","text":"","category":"section"},{"location":"api/#ReplicateBE.rbe","page":"Api","title":"ReplicateBE.rbe","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.rbe","category":"page"},{"location":"api/#ReplicateBE.rbe","page":"Api","title":"ReplicateBE.rbe","text":"rbe(df; dvar::Symbol,\n    subject::Symbol,\n    formulation::Symbol,\n    period::Symbol,\n    sequence::Symbol,\n    g_tol::Float64 = 1e-8, x_tol::Float64 = 0.0, f_tol::Float64 = 0.0,\n    iterations::Int = 100,\n    store_trace = false, extended_trace = false, show_trace = false,\n    memopt = true,\n    init = [],\n    postopt = false, maxopttry = 100)\n\n\nMixed model fitting function for replicate bioequivalence without data preparation (apply categorical! for each factor and sort! to dataframe).\n\nMixed model in matrix form:\n\ny = Xbeta + Zu + epsilon\n\nwith covariance matrix for each subject:\n\nV_i = Z_iGZ_i+R_i\n\nArguments\n\ndf - DataFrame with data;\n\nKeywords:\n\ndvar - dependent variable;\nsubject - subject factor;\nformulation - formulation factor;\nperiod - period factor;\nsequence - sequence factor;\ng_tol = 1e-8\nx_tol = 0.0\nf_tol = 0.0\niterations = 100 - maximum iteration for optimization\nstore_trace = false\nextended_trace = false\nshow_trace = false\nmemopt = true - memory optimization (function cache)\ninit = [] - initial variance paremeters\npostopt = false - post optimization\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.rbe!","page":"Api","title":"ReplicateBE.rbe!","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.rbe!","category":"page"},{"location":"api/#ReplicateBE.rbe!","page":"Api","title":"ReplicateBE.rbe!","text":"This function can convert non-categorical to categorical and sort dataframe.\n\nIt can takes more time, but can help to avoid some errors like: \"ERROR: type ContinuousTerm has no field contrasts\".\n\n\n\n\n\n","category":"function"},{"location":"api/#StatsBase.coef","page":"Api","title":"StatsBase.coef","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"coef","category":"page"},{"location":"api/#StatsBase.coef","page":"Api","title":"StatsBase.coef","text":"coef(rbe::RBE)\n\nReturn model coefficients.\n\nbeta = (sum_i=1^n X_iV_i^-1X_i)^-1(sum_i=1^n X_iV_i^-1y_i)\n\n\n\n\n\n","category":"function"},{"location":"api/#StatsBase.confint","page":"Api","title":"StatsBase.confint","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"confint","category":"page"},{"location":"api/#StatsBase.confint","page":"Api","title":"StatsBase.confint","text":"confint(obj::RBE; level::Real=0.95, expci::Bool = false, inv::Bool = false, df = :sat)\n\nCompute confidence intervals for coefficients, with confidence level level (by default 95%).\n\nArguments\n\nexpci = true: return exponented CI.\ninv = true: return -estimate ± t(alpha, df)*SE\ndf = :sat: use Satterthwaite DF approximation.\ndf = :df3 or df = :cont: DF (contain) = N - rank(ZX).\n\nCI = estimate  t(alpha df)*SE\n\n\n\n\n\n","category":"function"},{"location":"api/#StatsBase.dof","page":"Api","title":"StatsBase.dof","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"dof","category":"page"},{"location":"api/#StatsBase.dof","page":"Api","title":"StatsBase.dof","text":"dof(rbe::RBE)\n\nReturn the number of degrees of freedom for the coefficients of the model.\n\n\n\n\n\n","category":"function"},{"location":"api/#StatsBase.stderror","page":"Api","title":"StatsBase.stderror","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"stderror","category":"page"},{"location":"api/#StatsBase.stderror","page":"Api","title":"StatsBase.stderror","text":"StatsBase.stderror(rbe::RBE)\n\nReturn the standard errors for the coefficients of the model.\n\nse = sqrtLCL\n\nwhere\n\nC = (sum_i=1^n X_iV_i^-1X_i)^-1\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.coefnum","page":"Api","title":"ReplicateBE.coefnum","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.coefnum","category":"page"},{"location":"api/#ReplicateBE.coefnum","page":"Api","title":"ReplicateBE.coefnum","text":"coefnum(rbe::RBE)\n\nReturn number of coefficients (length β).\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.contrast","page":"Api","title":"ReplicateBE.contrast","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.contrast","category":"page"},{"location":"api/#ReplicateBE.contrast","page":"Api","title":"ReplicateBE.contrast","text":"contrast(rbe::RBE, L::Matrix; name = \"Contrast\", memopt = true)::ContrastTable\n\nReturn contrast table for L matrix. Table include:\n\nF\nNumDF\nDF\nP|f|\n\nF = fracbetaL(LCL)^-1Lbetarank(LCL)\n\nwhere\n\nC = (sum_i=1^n X_iV_i^-1X_i)^-1\n\nDF for one-dimetion case:\n\ndf = frac2(LCL)^2gAg\n\nwhere A = 2H^-1\n\nwhere g = triangledown _theta(LC_thetaL)\n\nDF for multi-dimention case see Schaalje et al 2002.\n\np value calculated with:\n\npval    = ccdf(FDist(numdf, df), F)\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.design","page":"Api","title":"ReplicateBE.design","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.design","category":"page"},{"location":"api/#ReplicateBE.design","page":"Api","title":"ReplicateBE.design","text":"design(rbe::RBE)::Design\n\nReturn design information object.\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.estimate","page":"Api","title":"ReplicateBE.estimate","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.estimate","category":"page"},{"location":"api/#ReplicateBE.estimate","page":"Api","title":"ReplicateBE.estimate","text":"estimate(rbe::RBE, L::Matrix; df = :sat, name = \"Estimate\", memopt = true, alpha = 0.05)\n\nReturn estimate table for L 1xp matrix. Table include:\n\nestimate value\nSE\nDF\nt\nP|t|\nCI Upper\nCI Lower\n\nestimate = Lbeta\n\nSE = sqrtLCL\n\nt = estimate  SE\n\nFor df = :sat:\n\ndf = frac2(LCL)^2gAg\n\nwhere\n\nC = (sum_i=1^n X_iV_i^-1X_i)^-1\n\nwhere A = 2H^-1\n\nwhere g = triangledown _theta(LC_thetaL)\n\nFor df = :cont (contain):\n\ndf = N - rank(ZX)\n\nCI estimate is:\n\nCI = estimate  t(alpha df)*SE\n\nExample of L matrix if length of fixed effect vector is 6, estimate for 4-th value:\n\nL = [0 0 0 1 0 0]\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.fixed","page":"Api","title":"ReplicateBE.fixed","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.fixed","category":"page"},{"location":"api/#ReplicateBE.fixed","page":"Api","title":"ReplicateBE.fixed","text":"fixed(rbe::RBE)\n\nReturn fixed effect table (β).\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.optstat","page":"Api","title":"ReplicateBE.optstat","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.optstat","category":"page"},{"location":"api/#ReplicateBE.optstat","page":"Api","title":"ReplicateBE.optstat","text":"optstat(rbe::RBE)\n\nReturn optimization status.\n\ntrue - converged\nfalse - not converged\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.randrbeds","page":"Api","title":"ReplicateBE.randrbeds","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.randrbeds","category":"page"},{"location":"api/#ReplicateBE.randrbeds","page":"Api","title":"ReplicateBE.randrbeds","text":"    randrbeds(;n=24, sequence=[1,1],\n        design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\n        inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2],\n        intercept = 0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\n        formcoef = [0.0, 0.0],\n        dropobs::Int = 0, seed::Int = 0)\n\nRandom dataset generation for bioequivalence.\n\nKeywords\n\nn=24 - number of subjects;\nsequence = 11 -  distribution in sequences [1,1] means 1:1, [1,3] - 1:4 etc.;\ndesign = T R T R R T R T - desin matrix, each line is a sequence, each column - periods, cell - formulation id;\ninter=05 04 09 - inter-subject variance vector for G matrix (length 3): [σ₁, σ₂, ρ], where σ₁, σ₂ - formulation inter-subject variance,  ρ - covariance coefficient;\nintra=01 02 - intra-subject variance vector for R matrix (length 2): [σ₁, σ₂], where σ₁, σ₂ - formulation intra-subject variance for each formulation;\nintercept = 0 - intercept effect value;\nseqcoef = 00 00 - coefficients of sequences, additive (length(sequence) == length(seqcoef) == size(design, 1));\nperiodcoef = 00 00 00 00 - coefficients of periods, additive  (length(periodcoef) == size(design, 2));\nformcoef = 00 00 -  coefficients of formulations, additive ;\ndropobs = 0 number of randomly dropped observations;\nseed = 0 - seed for random number generator (0 - random seed).\n\nMultivariate normal disribution:\n\nf(mathbfx boldsymbolmu boldsymbolV) = frac1(2 pi)^d2 boldsymbolV^12\nexp left( - frac12 (mathbfx - boldsymbolmu)^T V^-1 (mathbfx - boldsymbolmu) right)\n\nWhere V:\n\nV_i = Z_iGZ_i+R_i\n\n\n\n\n\nAnother way to use:\n\n    randrbeds(n::Int, sequence::Vector,\n        design::Matrix,\n        θinter::Vector, θintra::Vector,\n        intercept::Real, seqcoef::Vector, periodcoef::Vector, formcoef::Vector,\n        dropsubj::Float64, dropobs::Int, seed::Int)\n\n\n\n\n\nUsing with RandRBEDS object:\n\nrandrbeds(task::RandRBEDS)\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.randrbetask","page":"Api","title":"ReplicateBE.randrbetask","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.randrbetask","category":"page"},{"location":"api/#ReplicateBE.randrbetask","page":"Api","title":"ReplicateBE.randrbetask","text":"randrbetask(;n=24, sequence=[1,1],\n        design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\n        inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2],\n        intercept = 0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [0.0, 0.0],\n        dropsubj = 0, dropobs::Int = 0, seed = 0)::RandRBEDS\n\nMake task for random dataset generation.\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.reml2","page":"Api","title":"ReplicateBE.reml2","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.reml2","category":"page"},{"location":"api/#ReplicateBE.reml2","page":"Api","title":"ReplicateBE.reml2","text":"reml2(rbe::RBE, θ::Vector{T}) where T <: AbstractFloat\n\nReturm -2logREML for rbe model with θ variance vector.\n\n\n\n\n\nreml2(rbe::RBE)\n\nReturm -2logREML for rbe model\n\nlogREML(thetabeta) = -fracN-p2 - frac12sum_i=1^nlogV_i-\n\n\n-frac12logsum_i=1^nX_iV_i^-1X_i-frac12sum_i=1^n(y_i - X_ibeta)V_i^-1(y_i - X_ibeta)\n\n\n\n\n\n-2 REML function for ForwardDiff\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.simulation","page":"Api","title":"ReplicateBE.simulation","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.simulation","category":"page"},{"location":"api/#ReplicateBE.simulation","page":"Api","title":"ReplicateBE.simulation","text":"simulation(task::RandRBEDS; io = stdout, verbose = false, num = 100,\n    l = log(0.8), u = log(1.25), seed = 0)\n\nCount successful BE outcomes.\n\nParameters\n\ntask -  RandRBEDS object\n\nKeywords\n\nio = stdout - text output\nverbose = false - print messages to io\nnum = 100 - number of simulations\nl = log(08) - lower bound\nu = log(125) - upper bound\nseed = 0 - seed for random number generator (0 - random seed)\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.theta","page":"Api","title":"ReplicateBE.theta","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.theta","category":"page"},{"location":"api/#ReplicateBE.theta","page":"Api","title":"ReplicateBE.theta","text":"theta(rbe::RBE)\n\nReturn theta (θ) vector (vector of variation parameters from optimization procedure).\n\n\n\n\n\n","category":"function"},{"location":"api/#ReplicateBE.typeiii","page":"Api","title":"ReplicateBE.typeiii","text":"","category":"section"},{"location":"api/","page":"Api","title":"Api","text":"ReplicateBE.typeiii","category":"page"},{"location":"api/#ReplicateBE.typeiii","page":"Api","title":"ReplicateBE.typeiii","text":"typeiii(rbe::RBE)\n\nReturn TYPE III table.\n\n(see contrast)\n\n\n\n\n\n","category":"function"},{"location":"details/#Introduction","page":"Details","title":"Introduction","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"(Image: doi)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"The replicate designed bioequivalence is a powerful approach to get more information about variation. In some cases the number of subjects required to demonstrate bioequivalence can be reduced by up to about 50% (Van Peer, A., 2010). For a high variability product, replication can really improve the precision and provide more complete intra-individual variation estimate. Also replicate design could be used for reference-scaled average bioequivalence (RSABE) to demonstrate bioequivalence for highly variable drugs (HVDs). With accordance to US FDA guideline linear mixed-effects model procedures, available in PROC MIXED in SAS or equivalent software, should be used for the analysis of replicated crossover studies for average BE (US FDA). At this moment linear mixed model effect analysis can be done with proprietary (SPSS, SAS, Stata) and open source (R:nlme, R:lme4, Julia:MixedModels) software. But not all statistical mixed models packages support flexible covariance structure fitting with structures like “heterogeneous compound symmetry” (CSH), FA0(2). This doesn’t means that lme4 or MixedModels can’t be used for bioequivalence estimation,  but CSH structure not available in this packages and comparison of results performed in SAS/SPSS with lme4 can be problematically. Objective of this work is: to provide instrument to make bioequivalence analysis with type C model and a development of a demonstrative code for step-by-step clarification of mixed model computation procedure for any interested developers.","category":"page"},{"location":"details/#Materials-and-Methods","page":"Details","title":"Materials and Methods","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"FDA recommended model can be described with following equation (Patterson, 2002; US FDA):","category":"page"},{"location":"details/","page":"Details","title":"Details","text":" Y_ijkl = mu_k + gamma_ikl + delta_ijk + varepsilon_ijkl","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where  i=1s indicates sequence, j=1n_i - subjects,  k=RT – treatment, l=12 indicates replicate on treatment k for subjects within sequence i. Y_ijkl is the response of replicate l on treatment k for subject j in sequence i, γ_ikl represents the fixed effect of replicate l on treatment k in sequence i, δ_ijk is the random subject effect for subject j  in sequence i on treatment k, and ε_ijkl is the random error for subject j within sequence i on replicate l of treatment k.  The ε_ijkl are assumed to be mutually independent and identically distributed as","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"varepsilon_ijkl sim N(0 sigma_Wk^2)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"And the random subject effects are assumed to be mutually independent and distributed as","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"delta_ij sim N_2\nbeginbmatrix\n    beginpmatrix  mu_R   mu_T end\n    pmatrixbeginpmatrixsigma_BR^2   rhosigma_BTsigma_BR \n    rhosigma_BTsigma_BR  sigma_BR^2\n    endpmatrix\nendbmatrix","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Following code illustrates an example of program statements to run the average bioequivalence analysis using PROC MIXED in SAS:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"PROC MIXED;\nCLASSES SEQ SUBJ PER TRT;\nMODEL  Y = SEQ PER TRT/ DDFM=SATTERTH;\nRANDOM  TRT/TYPE=FA0(2) SUB=SUBJ G;\nREPEATED/GRP=TRT SUB=SUBJ;\nESTIMATE 'T vs. R' TRT 1 -1/CL ALPHA=0.1;","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Statement TYPE=CSH also can be used to match the model described above.","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"In matrix notation a mixed effect model can be represented as:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"y = Xbeta + Zu + epsilon","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"And gives Henderson's «mixed model equations»:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"beginpmatrixXR^-1XXR^-1ZZR^-1XZR^-1Z+G_-1endpmatrix  beginpmatrixwidehatbeta  widehatu endpmatrix= beginpmatrixXR^-1yZR^-1yendpmatrix","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"The solution to the mixed model equations is a maximum likelihood estimate when the distribution of the errors is normal. PROC MIXED in SAS used restricted maximum likelihood (REML) approach by default. REML equation can be described with following (Henderson,  1959;Laird et.al. 1982; Jennrich 1986; Lindstrom & Bates, 1988; Gurka et.al 2006):","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"logREML(thetabeta) = -fracN-p2 - frac12sum_i=1^nlogV_i-\n\n-frac12logsum_i=1^nX_iV_i^-1X_i-frac12sum_i=1^n(y_i - X_ibeta)V_i^-1(y_i - X_ibeta)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"beta = (sum_i=1^n X_iV_i^-1X_i)^-1(sum_i=1^n X_iV_i^-1y_i)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"V_i = Z_iGZ_i+R_i","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where N – total number of observations, n – number of independent sampling units (subjects), y_i individual response vector,  X_i individual design matrix of fixed effects, β vector of fixed effects parameters, V_i individual covariance matrix for the response vector, Z_i individual design matrix of random effects,  G covariance matrix of u (random effect), R_i individual covariance matrix  of  ϵ (residual error). Finding solution for minimization  -2logL(θ) respectively to θ can be done with Newton’s family methods. In ReplicateBE used optimization with Optim.jl package (Newton's Method). In some cases post-optimization step can be performed with  Broyden–Fletcher–Goldfarb–Shanno  method ((L)-BFGS)(Fletcher & Roger, 1987; Wright, 2006). Because variance have only positive values and ρ is limited as -1 ≤ ρ ≤1 in CSH (SAS implementation) and 0 ≤ ρ ≤1 in ReplicateBE \"link\" function is used. Exponential values is optimizing in variance part and ρ is linked with sigmoid function. All steps perform with differentiable functions with forward automatic differentiation using ForwardDiff package. ForwardDiff is a Julia package for forward-mode automatic differentiation (AD) featuring performance competitive with low-level languages like C++. Unlike recently developed AD tools in other popular high-level languages such as Python and MATLAB, ForwardDiff takes advantage of just-in-time (JIT) compilation to transparently recompile AD-unaware user code, enabling efficient support for higher-order differentiation and differentiation using custom number types (including complex numbers). The field of automatic differentiation provides methods for automatically computing exact derivatives (up to floating-point error) given only the function itself (Revels et al., 2016; Mogensen et al., 2018).","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"After solving optimization problem other statistical parameters can be found (Giesbrecht & Burns, 1985; Hrong-Tai Fai & Corneliu 1996; Schaalje et al 2002):","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"F = fracbetaL(LCL)^-1Lbetarank(LCL)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"C = (sum_i=1^n X_iV_i^-1X_i)^-1","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"And","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"se = sqrtLCL","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Degree of freedom (DF) computed with Satterthwaite approximation or with “contain” method (N – rank(XZ)).","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"df = frac2(LCL)^2gAg","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where  A = 2H^-1; g = triangledown_theta(LC_thetaL)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Where L is a vector of known constant, C – variance-covariance matrix of fixed effects (var(β)), H – hessian matrix of REML function, N – total number of observations.","category":"page"},{"location":"details/#Validation","page":"Details","title":"Validation","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"ReplicateBE was validated with 6 reference public datasets, 29 generated datasets and simulation study. ReplicateBE is compliant to SAS/SPSS when comparing the following parameters: REML estimate, variance components estimate, fixed effect estimate, standard error of fixed effect estimate. Validation procedures included in package test procedure and perform each time when new version released or can be done at any time on user machine. Validation results (REML & 90% CI) table can be found here.","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"ReplicateBE include simulation utility, that based on generation multivariate distributed datasets. This can be used not only in purpose of the package diagnostics, but also in purpose of sample size estimation ets. Simulation using version 0.1.4 was performed with 100000 iterations. Confidence interval (95%) for type I error (alpha) is 0.048047 - 0.050733. No statistically significant difference found with acceptable rate (0.05) found. Other simulation results can be found here.","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Testing procedures cover approximately (Image: codecov) of code, and perform for each release on Travis CI platform: (Image: Build Status).","category":"page"},{"location":"details/#Installation-and-using","page":"Details","title":"Installation and using","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Installation:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"using Pkg; Pkg.add(\"ReplicateBE\")","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Basic using:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"using ReplicateBE, StatsBase\nbe = ReplicateBE.rbe!(df, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence);\nci = confint(be, 0.1)","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Standard output:","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"Bioequivalence Linear Mixed Effect Model (status: converged)\n\n-2REML: 329.257    REML: -164.629\n\nFixed effect:\n───────────────────────────────────────────────────────────────────────────────────────────\nEffect           Value         SE          F          DF        t           P|t|\n───────────────────────────────────────────────────────────────────────────────────────────\n(Intercept)      4.42158       0.119232    1375.21    68.6064   37.0838     4.02039E-47*   \nsequence: 2      0.360591      0.161776    4.96821    62.0      2.22895     0.0294511*     \nperiod: 2        0.027051      0.0533388   0.257206   122.73    0.507155    0.612956       \nperiod: 3        -0.00625777   0.0561037   0.012441   153.634   -0.111539   0.911334       \nperiod: 4        0.036742      0.0561037   0.428886   153.634   0.654894    0.513515       \nformulation: 2   0.0643404     0.0415345   2.39966    62.0      1.54908     0.126451       \n───────────────────────────────────────────────────────────────────────────────────────────\nIntra-individual variance:\nformulation: 1   0.108629    CVᵂ:   33.87   %   \nformulation: 2   0.0783544   CVᵂ:   28.55   %\n\nInter-individual variance:\nformulation: 1   0.377846\nformulation: 2   0.421356\nρ:               0.980288   Cov: 0.391143   \n\nConfidence intervals(90%):\nformulation: 1 / formulation: 2\nRatio: 93.77, CI: 87.49 - 100.5 (%)\nformulation: 2 / formulation: 1\nRatio: 106.65, CI: 99.5 - 114.3 (%)","category":"page"},{"location":"details/#Results","page":"Details","title":"Results","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"ReplicateBE was developed to get mixed model solution to bioequivalence clinical trial. Package repository: (Image: GitHub version), Julia 1.0.5 or latest should be installed.","category":"page"},{"location":"details/#Discussion","page":"Details","title":"Discussion","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"ReplicateBE not designed for modeling in a general purpose, but can be used in situation with similar structure. In part of datasets ReplicateBE showed better optimization result as SPSS. Also ReplicateBE based on direct inversing of variance-covarance matrix V, so computation of V^-1 may be time expensive if size of matrix is big. This does not happen in bioequivalence study where size of V is no more 4 (4 periods). But in general this can be serious performance disadvantage. This situation can be avoided using sweep based transformations (Wolfinger et al., 1994). In ReplicateBE variance structure strictly denoted and can’t be changed, but it can be a target in package developing path. In ReplicateBE Satterthwaite degree of freedom (DF) estimate is equal with SAS/SPSS DF estimate for full-replicated basic bioequivalence balanced and unbalanced datasets (2x2x4, 2x2x3), and can be unequal in datasets with dropouts. Validation results for half-replicated designs (2x3x3) or 2x4x4 designs can be found in validation results table.  ","category":"page"},{"location":"details/#Development-and-version-description","page":"Details","title":"Development and version description","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"Version format: XYZ","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"00Z - alpha release, not ready for publics deploy;\n0YZ - beta release, ready for publics deploy and testing;\n10Z - publics release with stable API and description of validation procedures, can be unstable or validation program can cover not all package functionality;\n110 - stable public release;","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"When Z changed - bugfix or minor changes, not affect on API.","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"When Y changed - minor patch, may include changes in functionality, but not include breaking changes.","category":"page"},{"location":"details/","page":"Details","title":"Details","text":"When X changed - major release, may include breaking changes.","category":"page"},{"location":"details/#Acknowledgments","page":"Details","title":"Acknowledgments","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"D.Sc. in Physical and Mathematical Sciences Anastasia Shitova a.shitova@qayar.ru","category":"page"},{"location":"details/#Literature-Cited","page":"Details","title":"Literature Cited","text":"","category":"section"},{"location":"details/","page":"Details","title":"Details","text":"FDA Guidance for Industry: Statistical Approaches to Establishing Bioequivalence, 2001\nFletcher, Roger (1987), Practical methods of optimization (2nd ed.), New York: John Wiley & Sons, ISBN 978-0-471-91547-8\nGiesbrecht, F. G., and Burns, J. C. (1985), \"Two-Stage Analysis Based on a Mixed Model: Large-sample Asymptotic Theory and Small-Sample Simulation Results,\" Biometrics, 41, 853-862.\nGurka, Matthew. (2006). Selecting the Best Linear Mixed Model under REML. The American Statistician. 60. 19-26. 10.1198/000313006X90396.\nHenderson, C. R., et al. “The Estimation of Environmental and Genetic Trends from Records Subject to Culling.” Biometrics, vol. 15, no. 2, 1959, pp. 192–218. JSTOR, www.jstor.org/stable/2527669.\nHrong-Tai Fai & Cornelius (1996) Approximate F-tests of multiple degree of freedom hypotheses in generalized least squares analyses of unbalanced split-plot experiments, Journal of Statistical Computation and Simulation, 54:4, 363-378, DOI: 10.1080/00949659608811740\nJennrich, R., & Schluchter, M. (1986). Unbalanced Repeated-Measures Models with Structured Covariance Matrices. Biometrics, 42(4), 805-820. doi:10.2307/2530695\nLaird, Nan M., and James H. Ware. “Random-Effects Models for Longitudinal Data.” Biometrics, vol. 38, no. 4, 1982, pp. 963–974. JSTOR, www.jstor.org/stable/2529876.\nLindstrom & J.; Bates, M. (1988). Newton—Raphson and EM Algorithms for Linear Mixed-Effects Models for Repeated-Measures Data. Journal of the American Statistical Association. 83. 1014. 10.1080/01621459.1988.10478693.\nMogensen et al., (2018). Optim: A mathematical optimization package for Julia. Journal of Open Source Software, 3(24), 615,doi: 10.21105/joss.00615\nPatterson, S. D. and Jones, B. (2002), Bioequivalence and the pharmaceutical industry. Pharmaceut. Statist., 1: 83-95. doi:10.1002/pst.15\nRevels, Jarrett & Lubin, Miles & Papamarkou, Theodore. (2016). Forward-Mode Automatic Differentiation in Julia.\nSchaalje GB, McBride JB, Fellingham GW. Adequacy of approximations to distributions of test statistics in complex mixed linear models. J Agric Biol Environ Stat. 2002;7:512–24.\nVan Peer, A. (2010), Variability and Impact on Design of Bioequivalence Studies. Basic & Clinical Pharmacology & Toxicology, 106: 146-153. doi:10.1111/j.1742-7843.2009.00485.x\nWolfinger et al., (1994) Computing gaussian likelihoods and their derivatives for general linear mixed models doi: 10.1137/0915079\nWright, Stephen, and Jorge Nocedal (2006) \"Numerical optimization.\" Springer","category":"page"},{"location":"testval/#Validation","page":"Validation","title":"Validation","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"Validation program include public datasets and generated datasets. All public datasets include in test/testdata.jl.","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Generated datasets made with randrbeds function with fixed seed (could be reproduced at any time) and include following disignes:","category":"page"},{"location":"testval/#subjects,-balanced","page":"Validation","title":"24 subjects, balanced","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"1  TRTR/RTRT\n2  TRRT/RTTR\n3  TTRR/RRTT\n4  TRTR/RTRT/TRRT/RTTR\n5  TRRT/RTTR/TTRR/RRTT\n6  TRTR/RTRT/TTRR/RRTT\n7  TRT/RTR\n8  TRR/RTT\n9  TR/RT/TT/RR\n10 TRR/RTR/RRT\n11 TRR/RTR*","category":"page"},{"location":"testval/#subjects,-unbalanced,-20-dropped-observations","page":"Validation","title":"48 subjects, unbalanced, 20 dropped observations","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"12  TRTR/RTRT\n13  TRRT/RTTR\n14  TTRR/RRTT\n15  TRTR/RTRT/TRRT/RTTR\n16  TRRT/RTTR/TTRR/RRTT\n17  TRTR/RTRT/TTRR/RRTT\n18  TRT/RTR\n19  TRR/RTT\n20  TR/RT/TT/RR\n21 TRR/RTR/RRT\n22 TRR/RTR","category":"page"},{"location":"testval/#subject-unbalanced-dataset","page":"Validation","title":"36 subject unbalanced dataset","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"23 TRTR/RTRT\n24 TRT/RTR","category":"page"},{"location":"testval/#subject,-8-repeat","page":"Validation","title":"24 subject, №8 repeat","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"25 TRR/RTT","category":"page"},{"location":"testval/#subject-unbalanced-dataset-2","page":"Validation","title":"128 subject unbalanced dataset","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"26 TRTR/RTRT\n27 TRT/RTR","category":"page"},{"location":"testval/#subject-unbalanced-dataset-3","page":"Validation","title":"512 subject unbalanced dataset","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"28 TRTR/RTRT\n29 TRT/RTR","category":"page"},{"location":"testval/#Special-cases","page":"Validation","title":"Special cases","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"* 101 SP1: TRTR/RTRT 1024 subjects, 2000 dropped observations\n* 102 SP2: TRT/RTR 4096 subjects, 2000 dropped observations (total 10288 observations)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Datasets can be found here.","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"SP1 output:","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"rds = ReplicateBE.randrbeds(;n=1024, sequence=[1,2], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [0.0, 0.1], dropobs = 2000, seed = 10101)\n@time be = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)\n  6.107196 seconds (14.51 M allocations: 981.933 MiB, 8.28% gc time)\nBioequivalence Linear Mixed Effect Model (status: converged)\n\n-2REML: 4032.92    REML: -2016.46\n\nFixed effect:\n─────────────────────────────────────────────────────────────────────────────────────────────\nEffect           Value         SE          F           DF        t           P|t|\n─────────────────────────────────────────────────────────────────────────────────────────────\n(Intercept)      1.17091       0.0342916   1165.94     1215.96   34.1458     9.58974e-180*\nsequence: TRTR   -0.0230415    0.0497151   0.214805    976.825   -0.463471   0.64313\nperiod: 2        -0.0118358    0.0300503   0.15513     1397.78   -0.393865   0.69374\nperiod: 3        -0.00522645   0.0288399   0.0328418   1139.11   -0.181223   0.856225\nperiod: 4        -0.0271755    0.0300382   0.81848     1398.08   -0.904699   0.365781\nformulation: T   -0.102651     0.0231198   19.7131     1445.78   -4.43995    9.68179e-6*\n─────────────────────────────────────────────────────────────────────────────────────────────\nIntra-individual variation:\nformulation: R   0.202459\nformulation: T   0.105328\n\nInter-individual variation:\nformulation: R   0.396337\nformulation: T   0.52727\nρ:               0.933991   Cov: 0.426964\n\nConfidence intervals(90%):\nformulation: R / formulation: T\n86.8747 - 93.7445 (%)\nformulation: T / formulation: R\n106.673 - 115.1083 (%)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"SP2 output:","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"rds = ReplicateBE.randrbeds(;n=4096, sequence=[1,4], design = [\"T\" \"R\" \"T\"; \"R\" \"T\" \"R\"], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.9], intercept = 1.0, seqcoef = [10.0, 0.0], periodcoef = [0.0, 0.0, 0.0], formcoef = [0.0, 1.0], dropobs = 2000, seed = 10102)\nbe = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)\n312.655087 seconds (269.38 M allocations: 14.273 GiB, 1.47% gc time)\nBioequivalence Linear Mixed Effect Model (status: converged)\n\n-2REML: 26633.2    REML: -13316.6\n\nFixed effect:\n───────────────────────────────────────────────────────────────────────────────────────\nEffect           Value         SE          F          DF        t           P|t|\n───────────────────────────────────────────────────────────────────────────────────────\n(Intercept)      1.99206       0.0184652   11638.4    4779.03   107.882     0.0*\nsequence: TRT    10.0134       0.0322104   96643.1    5028.62   310.875     0.0*\nperiod: 2        0.0193164     0.0223827   0.744777   6811.0    0.863005    0.388165\nperiod: 3        -0.00501682   0.0152331   0.108463   1577.27   -0.329338   0.741944\nformulation: T   -0.995365     0.0210042   2245.71    6298.6    -47.3889    0.0*\nIntra-individual variation:\nformulation: R   0.885914\nformulation: T   0.106905\n\nInter-individual variation:\nformulation: R   0.380248\nformulation: T   0.491359\nρ:               0.902941   Cov: 0.390294\n\nConfidence intervals(90%):\nformulation: R / formulation: T\n35.7036 - 38.2583 (%)\nformulation: T / formulation: R\n261.3815 - 280.0838 (%)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"SAS procedures for generated datasets can be found in validation/sas/ folder.","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"All validation datasets (except special - SPX) include in package test procedure.","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"SAS WARNING: Stopped because of infinite likelihood.","category":"page"},{"location":"testval/#Simulation","page":"Validation","title":"Simulation","text":"","category":"section"},{"location":"testval/#v0.1.4","page":"Validation","title":"v0.1.4","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":"Following simulation was performed for version v0.1.4 (100000 iterations):","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"  using Distributions, ReplicateBE\n  function simulation(num)\n    n   = 0\n    err = 0\n    cnt = 0\n    b = l = log(0.8)\n    u = log(1.25)\n    println(\"Start...\")\n    for i = 1:num\n        try\n            rds   = ReplicateBE.randrbeds(;n=24, sequence=[1,1], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"], inter=[0.2, 0.2, 0.5], intra=[0.05, 0.05], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [b, 0.0])\n            be    = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence, memopt = false)\n            q     = quantile(TDist(be.fixed.df[6]), 0.95)\n            ll    = be.fixed.est[6] - q*be.fixed.se[6]\n            ul    = be.fixed.est[6] + q*be.fixed.se[6]\n            if ll > l && ul < u cnt += 1 end\n            if n > 1000\n                println(\"Iteration: $i\")\n                println(\"Mem: $(Sys.free_memory()/2^20)\")\n                println(\"Pow: $(cnt/i)\")\n                println(\"-------------------------------\")\n                n = 0\n            end\n            n += 1\n        catch\n            err += 1\n            println(\"Error $(err)!\")\n        end\n    end\n    return cnt/num\nend\n\nsimulation(100000)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Rusults:","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":" 7104.944474 seconds (9.51 G allocations: 2.230 TiB, 44.90% gc time)\n0.04939","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Confidence interval (95%) for power: 0.048047 - 0.050733. No statistically significant difference found.","category":"page"},{"location":"testval/#v1.0.0","page":"Validation","title":"v1.0.0","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":" task = ReplicateBE.RandRBEDS(;n=24,\n sequence=[1,2], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\n inter=[0.05, 0.04, 0.6], intra=[0.02, 0.04],\n intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\n formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)\n\n @time result =  ReplicateBE.simulation(task; num = 100000, seed = 730795390628834530, verbose = true)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"1837.914923 seconds (3.99 G allocations: 1.092 TiB, 9.91% gc time)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Seed: 730795390628834530","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Number: 100000","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Result: 0.05078660225829358","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"CI: Estimate: 0.05079 (0.04943 - 0.05215)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":" task = ReplicateBE.RandRBEDS(;n=24,\n sequence=[1,2], design = [\"T\" \"R\" \"T\"; \"R\" \"T\" \"R\"],\n inter=[0.05, 0.04, 0.4], intra=[0.02, 0.04],\n intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0],\n formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)\n\n @time result =  ReplicateBE.simulation(task; num = 100000, seed = 730795390628834530, verbose = true)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"1638.566348 seconds (3.77 G allocations: 907.478 GiB, 9.77% gc time)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Seed: 730795390628834530","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Number: 100000","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Result: 0.04997148203368122","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"CI: Estimate: 0.04997 (0.04862 - 0.05132)","category":"page"},{"location":"testval/#version-v1.0.1","page":"Validation","title":"version v1.0.1","text":"","category":"section"},{"location":"testval/","page":"Validation","title":"Validation","text":" task = ReplicateBE.RandRBEDS(;n=24,\n sequence=[1,2], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\n inter=[0.05, 0.04, 0.5], intra=[0.02, 0.04],\n intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\n formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)\n\n result =  ReplicateBE.simulation(task; num = 1000000, seed = 656468377477, verbose = true)","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Seed: 656468377477","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Number: 1000000","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"Result: 0.050228","category":"page"},{"location":"testval/","page":"Validation","title":"Validation","text":"CI: Estimate: 0.0502 (0.0498 - 0.0507)","category":"page"},{"location":"examples/#Bioequivalence-example","page":"Examples","title":"Bioequivalence example","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"using CSV, DataFrames, ReplicateBE, StatsBase\n\n#Load Dataframe...\n\ndf=CSV.read(IOBuffer(\"\"\"subject,sequence,period,formulation,var\n1,1,1,1,1.0\n1,1,2,2,1.1\n1,1,3,1,1.2\n1,1,4,2,1.3\n2,1,1,1,2.0\n2,1,2,2,2.1\n2,1,3,1,2.4\n2,1,4,2,2.2\n3,2,1,2,1.3\n3,2,2,1,1.5\n3,2,3,2,1.6\n3,2,4,1,1.4\n4,2,1,2,1.5\n4,2,2,1,1.7\n4,2,3,2,1.3\n4,2,4,1,1.4\n5,2,1,2,1.5\n5,2,2,1,1.7\n5,2,3,2,1.2\n5,2,4,1,1.8\"\"\")) |> DataFrame\n\n#Execute BE\n\nbe = rbe!(df, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)\n\n#Get fixed effect object\n\nfixed(be)\n\n#Get Type III object\n\ntypeiii(be)\n\n#Get model coefficients\n\ncoef(be)\n\n#Get Standard Error for coefficients\n\nstderror(be)\n\n#Get confidence intervals for all coefficients\n\nconfint(be, 0.1, expci = false, inv = false)\n\n#Get -2 REML for model\n\nreml2(be)\n\n#Design information\n\ndesign(be)","category":"page"},{"location":"examples/#Random-dataset-generation","page":"Examples","title":"Random dataset generation","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"using ReplicateBE\n\ntask = ReplicateBE.randrbetask(;n=24,\nsequence=[1,1], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\ninter=[0.05, 0.04, 0.6], intra=[0.02, 0.02],\nintercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\nformcoef = [0.0, log(0.8)], seed = 1234, dropobs = 10)\n\ndf = ReplicateBE.randrbeds(task)\n\n#or\n\ndf = ReplicateBE.randrbeds(;n=24,\nsequence=[1,1], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\ninter=[0.05, 0.04, 0.6], intra=[0.02, 0.02],\nintercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\nformcoef = [0.0, log(0.8)], seed = 1234, dropobs = 10)\n","category":"page"},{"location":"examples/#Simulation","page":"Examples","title":"Simulation","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"\nusing ReplicateBE\n\ntask = ReplicateBE.randrbetask(;n=24,\nsequence=[1,1], design = [\"T\" \"R\" \"T\" \"R\"; \"R\" \"T\" \"R\" \"T\"],\ninter=[0.05, 0.04, 0.6], intra=[0.02, 0.02],\nintercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],\nformcoef = [0.0, log(0.8)], seed = 0, dropobs = 10)\n\nresult =  ReplicateBE.simulation(task; num = 200, seed = 123)\n","category":"page"},{"location":"#ReplicateBE.jl-Documentation","page":"Home","title":"ReplicateBE.jl Documentation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = ReplicateBE","category":"page"},{"location":"","page":"Home","title":"Home","text":"ReplicateBE is a Julia package providing mixed model solution for replicate designed bioequivalence study. This can be used to obtained results with methods C (random effects with interaction), given by the EMA in Annex I. Statistical model formed with accordance FDA Guidance for Industry: Statistical Approaches to Establishing Bioequivalence, APPENDIX F.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Install:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg; Pkg.add(\"ReplicateBE\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"or:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg; Pkg.clone(\"https://github.com/PharmCat/ReplicateBE.jl.git\")","category":"page"},{"location":"#Contents","page":"Home","title":"Contents","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Pages = [\n        \"examples.md\",\n        \"syntax.md\",\n        \"details.md\",\n        \"testval.md\",\n        \"struct.md\",\n        \"api.md\"]\nDepth = 3","category":"page"},{"location":"syntax/#Simple-(modifying)-syntax","page":"Syntax","title":"Simple (modifying) syntax","text":"","category":"section"},{"location":"syntax/","page":"Syntax","title":"Syntax","text":"Simple syntax can be used in general purpose. Can modify df DataFrame.","category":"page"},{"location":"syntax/","page":"Syntax","title":"Syntax","text":"rbe!(df; dvar::Symbol, subject::Symbol, formulation::Symbol, period::Symbol, sequence::Symbol)","category":"page"},{"location":"syntax/#Simple-(non-modifying)-syntax","page":"Syntax","title":"Simple (non-modifying) syntax","text":"","category":"section"},{"location":"syntax/","page":"Syntax","title":"Syntax","text":"rbe!(df; dvar::Symbol, subject::Symbol, formulation::Symbol, period::Symbol, sequence::Symbol)","category":"page"},{"location":"syntax/#Random-dataset","page":"Syntax","title":"Random dataset","text":"","category":"section"},{"location":"syntax/","page":"Syntax","title":"Syntax","text":"Random dataset function is made for generation validation datasets and simulation data.","category":"page"},{"location":"syntax/#Simulation","page":"Syntax","title":"Simulation","text":"","category":"section"},{"location":"syntax/","page":"Syntax","title":"Syntax","text":"Simulation based on work with task - RandRBEDS object. Purpose of simulation to count successful BE outcomes for power or alpha calculation. Also simulation used to test package stability.","category":"page"}]
}
