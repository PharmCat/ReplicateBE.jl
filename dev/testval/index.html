<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Validation · ReplicateBE</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ReplicateBE</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../syntax/">Syntax</a></li><li><a class="tocitem" href="../details/">Details</a></li><li class="is-active"><a class="tocitem" href>Validation</a><ul class="internal"><li><a class="tocitem" href="#Validation"><span>Validation</span></a></li><li><a class="tocitem" href="#Simulation"><span>Simulation</span></a></li></ul></li><li><a class="tocitem" href="../api/">Api</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Validation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Validation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/PharmCat/ReplicateBE.jl/blob/master/docs/src/testval.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Validation"><a class="docs-heading-anchor" href="#Validation">Validation</a><a id="Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Validation" title="Permalink"></a></h2><p>Validation program include public datasets and generated datasets. All public datasets include in test/testdata.jl.</p><p>Generated datasets made with <em>randrbeds</em> function with fixed seed (could be reproduced at any time) and include following disignes:</p><h3 id="subjects,-balanced"><a class="docs-heading-anchor" href="#subjects,-balanced">24 subjects, balanced</a><a id="subjects,-balanced-1"></a><a class="docs-heading-anchor-permalink" href="#subjects,-balanced" title="Permalink"></a></h3><ul><li>1  TRTR/RTRT</li><li>2  TRRT/RTTR</li><li>3  TTRR/RRTT</li><li>4  TRTR/RTRT/TRRT/RTTR</li><li>5  TRRT/RTTR/TTRR/RRTT</li><li>6  TRTR/RTRT/TTRR/RRTT</li><li>7  TRT/RTR</li><li>8  TRR/RTT</li><li>9  TR/RT/TT/RR</li><li>10 TRR/RTR/RRT</li><li>11 TRR/RTR*</li></ul><h3 id="subjects,-unbalanced,-20-dropped-observations"><a class="docs-heading-anchor" href="#subjects,-unbalanced,-20-dropped-observations">48 subjects, unbalanced, 20 dropped observations</a><a id="subjects,-unbalanced,-20-dropped-observations-1"></a><a class="docs-heading-anchor-permalink" href="#subjects,-unbalanced,-20-dropped-observations" title="Permalink"></a></h3><ul><li>12  TRTR/RTRT</li><li>13  TRRT/RTTR</li><li>14  TTRR/RRTT</li><li>15  TRTR/RTRT/TRRT/RTTR</li><li>16  TRRT/RTTR/TTRR/RRTT</li><li>17  TRTR/RTRT/TTRR/RRTT</li><li>18  TRT/RTR</li><li>19  TRR/RTT</li><li>20  TR/RT/TT/RR</li><li>21 TRR/RTR/RRT</li><li>22 TRR/RTR</li></ul><h3 id="subject-unbalanced-dataset"><a class="docs-heading-anchor" href="#subject-unbalanced-dataset">36 subject unbalanced dataset</a><a id="subject-unbalanced-dataset-1"></a><a class="docs-heading-anchor-permalink" href="#subject-unbalanced-dataset" title="Permalink"></a></h3><ul><li>23 TRTR/RTRT</li><li>24 TRT/RTR</li></ul><h3 id="subject,-8-repeat"><a class="docs-heading-anchor" href="#subject,-8-repeat">24 subject, №8 repeat</a><a id="subject,-8-repeat-1"></a><a class="docs-heading-anchor-permalink" href="#subject,-8-repeat" title="Permalink"></a></h3><ul><li>25 TRR/RTT</li></ul><h3 id="subject-unbalanced-dataset-2"><a class="docs-heading-anchor" href="#subject-unbalanced-dataset-2">128 subject unbalanced dataset</a><a class="docs-heading-anchor-permalink" href="#subject-unbalanced-dataset-2" title="Permalink"></a></h3><ul><li>26 TRTR/RTRT</li><li>27 TRT/RTR</li></ul><h3 id="subject-unbalanced-dataset-3"><a class="docs-heading-anchor" href="#subject-unbalanced-dataset-3">512 subject unbalanced dataset</a><a class="docs-heading-anchor-permalink" href="#subject-unbalanced-dataset-3" title="Permalink"></a></h3><ul><li>28 TRTR/RTRT</li><li>29 TRT/RTR</li></ul><h3 id="Special-cases"><a class="docs-heading-anchor" href="#Special-cases">Special cases</a><a id="Special-cases-1"></a><a class="docs-heading-anchor-permalink" href="#Special-cases" title="Permalink"></a></h3><pre><code class="language-none">* 101 SP1: TRTR/RTRT 1024 subjects, 2000 dropped observations
* 102 SP2: TRT/RTR 4096 subjects, 2000 dropped observations (total 10288 observations)</code></pre><p>Datasets can be found <a href="https://github.com/PharmCat/ReplicateBE.jl/tree/master/validation/csv">here</a>.</p><p>SP1 output:</p><pre><code class="language-none">rds = ReplicateBE.randrbeds(;n=1024, sequence=[1,2], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.2], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [0.0, 0.1], dropobs = 2000, seed = 10101)
@time be = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)
  6.107196 seconds (14.51 M allocations: 981.933 MiB, 8.28% gc time)
Bioequivalence Linear Mixed Effect Model (status: converged)

-2REML: 4032.92    REML: -2016.46

Fixed effect:
─────────────────────────────────────────────────────────────────────────────────────────────
Effect           Value         SE          F           DF        t           P|t|
─────────────────────────────────────────────────────────────────────────────────────────────
(Intercept)      1.17091       0.0342916   1165.94     1215.96   34.1458     9.58974e-180*
sequence: TRTR   -0.0230415    0.0497151   0.214805    976.825   -0.463471   0.64313
period: 2        -0.0118358    0.0300503   0.15513     1397.78   -0.393865   0.69374
period: 3        -0.00522645   0.0288399   0.0328418   1139.11   -0.181223   0.856225
period: 4        -0.0271755    0.0300382   0.81848     1398.08   -0.904699   0.365781
formulation: T   -0.102651     0.0231198   19.7131     1445.78   -4.43995    9.68179e-6*
─────────────────────────────────────────────────────────────────────────────────────────────
Intra-individual variation:
formulation: R   0.202459
formulation: T   0.105328

Inter-individual variation:
formulation: R   0.396337
formulation: T   0.52727
ρ:               0.933991   Cov: 0.426964

Confidence intervals(90%):
formulation: R / formulation: T
86.8747 - 93.7445 (%)
formulation: T / formulation: R
106.673 - 115.1083 (%)</code></pre><p>SP2 output:</p><pre><code class="language-none">rds = ReplicateBE.randrbeds(;n=4096, sequence=[1,4], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot;], inter=[0.5, 0.4, 0.9], intra=[0.1, 0.9], intercept = 1.0, seqcoef = [10.0, 0.0], periodcoef = [0.0, 0.0, 0.0], formcoef = [0.0, 1.0], dropobs = 2000, seed = 10102)
be = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence)
312.655087 seconds (269.38 M allocations: 14.273 GiB, 1.47% gc time)
Bioequivalence Linear Mixed Effect Model (status: converged)

-2REML: 26633.2    REML: -13316.6

Fixed effect:
───────────────────────────────────────────────────────────────────────────────────────
Effect           Value         SE          F          DF        t           P|t|
───────────────────────────────────────────────────────────────────────────────────────
(Intercept)      1.99206       0.0184652   11638.4    4779.03   107.882     0.0*
sequence: TRT    10.0134       0.0322104   96643.1    5028.62   310.875     0.0*
period: 2        0.0193164     0.0223827   0.744777   6811.0    0.863005    0.388165
period: 3        -0.00501682   0.0152331   0.108463   1577.27   -0.329338   0.741944
formulation: T   -0.995365     0.0210042   2245.71    6298.6    -47.3889    0.0*
Intra-individual variation:
formulation: R   0.885914
formulation: T   0.106905

Inter-individual variation:
formulation: R   0.380248
formulation: T   0.491359
ρ:               0.902941   Cov: 0.390294

Confidence intervals(90%):
formulation: R / formulation: T
35.7036 - 38.2583 (%)
formulation: T / formulation: R
261.3815 - 280.0838 (%)</code></pre><p>SAS procedures for generated datasets can be found in <a href="https://github.com/PharmCat/ReplicateBE.jl/tree/master/validation/sas"><em>validation/sas/</em></a> folder.</p><p>All validation datasets (except special - SPX) include in package test procedure.</p><p><em>SAS WARNING</em>: Stopped because of infinite likelihood.</p><h2 id="Simulation"><a class="docs-heading-anchor" href="#Simulation">Simulation</a><a id="Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation" title="Permalink"></a></h2><h3 id="v0.1.4"><a class="docs-heading-anchor" href="#v0.1.4">v0.1.4</a><a id="v0.1.4-1"></a><a class="docs-heading-anchor-permalink" href="#v0.1.4" title="Permalink"></a></h3><p>Following simulation was performed for version v0.1.4 (100000 iterations):</p><pre><code class="language-julia">  using Distributions, ReplicateBE
  function simulation(num)
    n   = 0
    err = 0
    cnt = 0
    b = l = log(0.8)
    u = log(1.25)
    println(&quot;Start...&quot;)
    for i = 1:num
        try
            rds   = ReplicateBE.randrbeds(;n=24, sequence=[1,1], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;], inter=[0.2, 0.2, 0.5], intra=[0.05, 0.05], intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0], formcoef = [b, 0.0])
            be    = ReplicateBE.rbe(rds, dvar = :var, subject = :subject, formulation = :formulation, period = :period, sequence = :sequence, memopt = false)
            q     = quantile(TDist(be.fixed.df[6]), 0.95)
            ll    = be.fixed.est[6] - q*be.fixed.se[6]
            ul    = be.fixed.est[6] + q*be.fixed.se[6]
            if ll &gt; l &amp;&amp; ul &lt; u cnt += 1 end
            if n &gt; 1000
                println(&quot;Iteration: $i&quot;)
                println(&quot;Mem: $(Sys.free_memory()/2^20)&quot;)
                println(&quot;Pow: $(cnt/i)&quot;)
                println(&quot;-------------------------------&quot;)
                n = 0
            end
            n += 1
        catch
            err += 1
            println(&quot;Error $(err)!&quot;)
        end
    end
    return cnt/num
end

simulation(100000)</code></pre><p>Rusults:</p><pre><code class="language-none"> 7104.944474 seconds (9.51 G allocations: 2.230 TiB, 44.90% gc time)
0.04939</code></pre><p>Confidence interval (95%) for power: 0.048047 - 0.050733. No statistically significant difference found.</p><h3 id="v1.0.0"><a class="docs-heading-anchor" href="#v1.0.0">v1.0.0</a><a id="v1.0.0-1"></a><a class="docs-heading-anchor-permalink" href="#v1.0.0" title="Permalink"></a></h3><pre><code class="language-julia"> task = ReplicateBE.RandRBEDS(;n=24,
 sequence=[1,2], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;],
 inter=[0.05, 0.04, 0.6], intra=[0.02, 0.04],
 intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],
 formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)

 @time result =  ReplicateBE.simulation(task; num = 100000, seed = 730795390628834530, verbose = true)</code></pre><p>1837.914923 seconds (3.99 G allocations: 1.092 TiB, 9.91% gc time)</p><p>Seed: 730795390628834530</p><p>Number: 100000</p><p>Result: 0.05078660225829358</p><p>CI: Estimate: 0.05079 (0.04943 - 0.05215)</p><pre><code class="language-julia"> task = ReplicateBE.RandRBEDS(;n=24,
 sequence=[1,2], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot;],
 inter=[0.05, 0.04, 0.4], intra=[0.02, 0.04],
 intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0],
 formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)

 @time result =  ReplicateBE.simulation(task; num = 100000, seed = 730795390628834530, verbose = true)</code></pre><p>1638.566348 seconds (3.77 G allocations: 907.478 GiB, 9.77% gc time)</p><p>Seed: 730795390628834530</p><p>Number: 100000</p><p>Result: 0.04997148203368122</p><p>CI: Estimate: 0.04997 (0.04862 - 0.05132)</p><h3 id="version-v1.0.1"><a class="docs-heading-anchor" href="#version-v1.0.1">version v1.0.1</a><a id="version-v1.0.1-1"></a><a class="docs-heading-anchor-permalink" href="#version-v1.0.1" title="Permalink"></a></h3><pre><code class="language-julia"> task = ReplicateBE.RandRBEDS(;n=24,
 sequence=[1,2], design = [&quot;T&quot; &quot;R&quot; &quot;T&quot; &quot;R&quot;; &quot;R&quot; &quot;T&quot; &quot;R&quot; &quot;T&quot;],
 inter=[0.05, 0.04, 0.5], intra=[0.02, 0.04],
 intercept = 1.0, seqcoef = [0.0, 0.0], periodcoef = [0.0, 0.0, 0.0, 0.0],
 formcoef = [0.0, log(0.8)], seed = 0, dropobs = 0)

 result =  ReplicateBE.simulation(task; num = 1000000, seed = 656468377477, verbose = true)</code></pre><p>Seed: 656468377477</p><p>Number: 1000000</p><p>Result: 0.050228</p><p>CI: Estimate: 0.0502 (0.0498 - 0.0507)</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../details/">« Details</a><a class="docs-footer-nextpage" href="../api/">Api »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 15 September 2020 01:54">Tuesday 15 September 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
